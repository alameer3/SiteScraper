{% extends "base.html" %}

{% block title %}Website Cloner Pro - أداة نسخ المواقع المتقدمة{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-10">
        <!-- Hero Section -->
        <div class="card mb-4">
            <div class="card-body text-center">
                <div class="feature-icon mx-auto mb-3">
                    <i data-feather="copy"></i>
                </div>
                <h1 class="card-title text-primary">Website Cloner Pro</h1>
                <p class="card-text text-muted">أداة متقدمة لنسخ المواقع الإلكترونية بالكامل مع الحفاظ على الهيكل والتصميم</p>
            </div>
        </div>

        <!-- Features Grid -->
        <div class="row mb-4">
            <div class="col-md-4 mb-3">
                <div class="card h-100">
                    <div class="card-body text-center">
                        <i data-feather="download" class="text-primary mb-3" style="width: 48px; height: 48px;"></i>
                        <h5 class="card-title">استنساخ كامل</h5>
                        <p class="card-text">نسخ شامل للموقع بما في ذلك HTML، CSS، JavaScript، والصور</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-3">
                <div class="card h-100">
                    <div class="card-body text-center">
                        <i data-feather="layers" class="text-success mb-3" style="width: 48px; height: 48px;"></i>
                        <h5 class="card-title">محافظة على البنية</h5>
                        <p class="card-text">الحفاظ على التسلسل الهرمي للملفات وهيكل المجلدات الأصلي</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-3">
                <div class="card h-100">
                    <div class="card-body text-center">
                        <i data-feather="zap" class="text-warning mb-3" style="width: 48px; height: 48px;"></i>
                        <h5 class="card-title">معالجة ذكية</h5>
                        <p class="card-text">تحليل وتحسين الكود المنسوخ لضمان العمل بشكل مستقل</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Clone Form -->
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">
                    <i data-feather="settings" class="me-2"></i>
                    إعدادات النسخ
                </h5>
            </div>
            <div class="card-body">
                <form id="cloneForm">
                    <div class="row">
                        <div class="col-md-8 mb-3">
                            <label class="form-label">رابط الموقع المراد نسخه</label>
                            <input type="url" class="form-control" id="websiteUrl" placeholder="https://example.com" required>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label class="form-label">عمق النسخ</label>
                            <select class="form-control" id="cloneDepth">
                                <option value="1">صفحة واحدة</option>
                                <option value="2" selected>مستويين</option>
                                <option value="3">ثلاثة مستويات</option>
                                <option value="all">الموقع كاملاً</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">أنواع الملفات</label>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="includeCSS" checked>
                                <label class="form-check-label" for="includeCSS">ملفات CSS</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="includeJS" checked>
                                <label class="form-check-label" for="includeJS">ملفات JavaScript</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="includeImages" checked>
                                <label class="form-check-label" for="includeImages">الصور والوسائط</label>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">خيارات متقدمة</label>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="followExternal">
                                <label class="form-check-label" for="followExternal">تتبع الروابط الخارجية</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="optimizeCode">
                                <label class="form-check-label" for="optimizeCode">تحسين الكود</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="createIndex" checked>
                                <label class="form-check-label" for="createIndex">إنشاء فهرس للملفات</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i data-feather="play-circle" class="me-2"></i>
                            بدء عملية النسخ
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Progress Section (Hidden initially) -->
        <div class="card mt-4" id="progressSection" style="display: none;">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">
                    <i data-feather="activity" class="me-2"></i>
                    حالة النسخ
                </h5>
            </div>
            <div class="card-body">
                <div class="progress mb-3">
                    <div class="progress-bar" role="progressbar" style="width: 0%">0%</div>
                </div>
                <div id="statusMessage" class="text-center">
                    <p class="mb-0">جاري التحضير...</p>
                </div>
            </div>
        </div>

        <!-- Results Section (Hidden initially) -->
        <div class="card mt-4" id="resultsSection" style="display: none;">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">
                    <i data-feather="check-circle" class="me-2"></i>
                    نتائج النسخ
                </h5>
            </div>
            <div class="card-body">
                <div id="resultsContent">
                    <!-- Results will be populated here -->
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.getElementById('cloneForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const url = document.getElementById('websiteUrl').value;
    const depth = document.getElementById('cloneDepth').value;
    
    if (!url) {
        alert('يرجى إدخال رابط الموقع');
        return;
    }
    
    // Show progress section
    document.getElementById('progressSection').style.display = 'block';
    document.getElementById('resultsSection').style.display = 'none';
    
    // Simulate cloning process (replace with actual API call)
    simulateCloning(url, depth);
});

function simulateCloning(url, depth) {
    const progressBar = document.querySelector('.progress-bar');
    const statusMessage = document.getElementById('statusMessage');
    let progress = 0;
    
    const steps = [
        'جاري تحليل الموقع...',
        'جاري تحميل الصفحات...',
        'جاري معالجة الأصول...',
        'جاري تحسين الكود...',
        'جاري إنشاء الملفات...',
        'تم الانتهاء بنجاح!'
    ];
    
    const interval = setInterval(() => {
        progress += 16.67;
        progressBar.style.width = progress + '%';
        progressBar.textContent = Math.round(progress) + '%';
        
        const stepIndex = Math.floor(progress / 16.67);
        if (stepIndex < steps.length) {
            statusMessage.innerHTML = `<p class="mb-0">${steps[stepIndex]}</p>`;
        }
        
        if (progress >= 100) {
            clearInterval(interval);
            showResults(url);
        }
    }, 1000);
}

function showResults(url) {
    document.getElementById('resultsSection').style.display = 'block';
    
    const resultsContent = document.getElementById('resultsContent');
    resultsContent.innerHTML = `
        <div class="alert alert-success">
            <h6 class="alert-heading">تم نسخ الموقع بنجاح!</h6>
            <p class="mb-0">تم نسخ الموقع <strong>${url}</strong> بنجاح. يمكنك الآن تحميل الملفات أو معاينة النتائج.</p>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body text-center">
                        <i data-feather="download" class="text-primary mb-2" style="width: 32px; height: 32px;"></i>
                        <h6>تحميل الملفات</h6>
                        <button class="btn btn-primary btn-sm">تحميل ZIP</button>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body text-center">
                        <i data-feather="eye" class="text-success mb-2" style="width: 32px; height: 32px;"></i>
                        <h6>معاينة النتائج</h6>
                        <button class="btn btn-success btn-sm">عرض التفاصيل</button>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    feather.replace();
}
</script>
{% endblock %}